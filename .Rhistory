data = movs$pts)
# nodes <- scale_nodes(nodes_df = nodes,
#                      to_scale = nodes$data,
#                      node_attr = 'width',
#                      range = c(1, 10))
# edges <- scale_edges(edges_df = edges,
#                      to_scale = edges$data,
#                      edge_attr = "minlen",
#                      range = c(2, 20))
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot")
graph_attrs <- c("layout = circo",
"overlap = false",
"fixedsize = true",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 800) %>%
cat(file = 'graph.svg')
percent_margin <- function(x, y) {
(x - y) / (x + y)
}
scale_1_5 <- function(x) {
(x - min(x)) / max(x) * 4 + 1
}
nfl2014 <- read.csv('nfl2014.csv') %>%
transmute(week = Week, winner = Winner, loser = Loser,
pts = percent_margin(PtsW, PtsL))
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum)
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts))
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
# nodes <- scale_nodes(nodes_df = nodes,
#                      to_scale = nodes$data,
#                      node_attr = 'width',
#                      range = c(1, 10))
# edges <- scale_edges(edges_df = edges,
#                      to_scale = edges$data,
#                      edge_attr = "minlen",
#                      range = c(2, 20))
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot")
graph_attrs <- c("layout = circo",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
percent_margin <- function(x, y) {
(x - y) / (x + y)
}
scale_1_5 <- function(x) {
(x - min(x)) / max(x) * 4 + 1
}
nfl2014 <- read.csv('nfl2014.csv') %>%
transmute(week = Week, winner = Winner, loser = Loser,
pts = percent_margin(PtsW, PtsL))
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum)
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts))
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
# nodes <- scale_nodes(nodes_df = nodes,
#                      to_scale = nodes$data,
#                      node_attr = 'width',
#                      range = c(1, 10))
# edges <- scale_edges(edges_df = edges,
#                      to_scale = edges$data,
#                      edge_attr = "minlen",
#                      range = c(2, 20))
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot")
graph_attrs <- c("layout = neato",
"overlap = true",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts))
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
# nodes <- scale_nodes(nodes_df = nodes,
#                      to_scale = nodes$data,
#                      node_attr = 'width',
#                      range = c(1, 10))
# edges <- scale_edges(edges_df = edges,
#                      to_scale = edges$data,
#                      edge_attr = "minlen",
#                      range = c(2, 20))
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot")
graph_attrs <- c("layout = neato",
"overlap = true",
"fixedsize = true",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts))
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot")
graph_attrs <- c("layout = neato",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts) / 10)
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot")
graph_attrs <- c("layout = twopi",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts) / 5)
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
node_attrs <- c("style = filled", "fillcolor = lightblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot",
"arrowsize = 0.2")
graph_attrs <- c("layout = twopi",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts) / 5)
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
node_attrs <- c("style = filled", "fillcolor = cadetblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot",
"arrowsize = 0.2",
"color = gray")
graph_attrs <- c("layout = circo",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
percent_margin <- function(x, y) {
(x - y) / (x + y)
}
scale_1_10 <- function(x) {
(x - min(x)) / max(x) * 9 + 1
}
nfl2014 <- read.csv('nfl2014.csv') %>%
transmute(week = Week, winner = Winner, loser = Loser,
pts = percent_margin(PtsW, PtsL))
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum)
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_5(teams$pts) / 5)
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
edges <- scale_edges(edges_df = edges,
to_scale = edges$data,
edge_attr = "penwidth",
range = c(1, 5))
node_attrs <- c("style = filled", "fillcolor = cadetblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = dot",
"arrowsize = 1",
"color = gray")
graph_attrs <- c("layout = circo",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_10(teams$pts) / 5)
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
percent_margin <- function(x, y) {
(x - y) / (x + y)
}
scale_1_10 <- function(x) {
(x - min(x)) / max(x) * 9 + 1
}
nfl2014 <- read.csv('nfl2014.csv') %>%
transmute(week = Week, winner = Winner, loser = Loser,
pts = percent_margin(PtsW, PtsL))
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum)
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_10(teams$pts) / 5)
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
edges <- scale_edges(edges_df = edges,
to_scale = edges$data,
edge_attr = "penwidth",
range = c(1, 10))
node_attrs <- c("style = filled", "fillcolor = cadetblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = vee",
"arrowsize = 0.5",
"color = salmon")
graph_attrs <- c("layout = circo",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
View(teams)
nodes <- create_nodes(nodes = teams$winner,
label = FALSE,
tooltip = teams$winner,
width = scale_1_10(teams$pts) / 5)
edges <- create_edges(from = movs$winner,
to = movs$loser,
data = movs$pts)
edges <- scale_edges(edges_df = edges,
to_scale = edges$data,
edge_attr = "penwidth",
range = c(1, 5))
node_attrs <- c("style = filled", "fillcolor = cadetblue",
"color = gray", "shape = circle",
"fontname = Helvetica")
edge_attrs <- c("arrowhead = vee",
"arrowsize = 1",
"color = slategray")
graph_attrs <- c("layout = circo",
"overlap = false",
"fixedsize = false",
"ranksep = 3",
"outputorder = edgesfirst")
create_graph(nodes_df = nodes,
edges_df = edges,
graph_attrs = graph_attrs,
node_attrs = node_attrs,
edge_attrs = edge_attrs) %>%
render_graph(output = 'SVG', width = 1200, height = 1200) %>%
cat(file = 'graph.svg')
devtools::create('nfl-gv')
devtools::create('nflgv')
library(nflgv)
devtools::use_vignette('nfl-gv')
install.packages('rmarkdown')
devtools::use_vignette('nfl-gv')
<img src='graph.svg' height=800px width=800px>
install.packages('htmltools')
install.packages("htmltools")
library(nflgv)
library(nflgv)
library(nflgv)
devtools::build()
dir()
knitr::knit('vignettes/nfl-gv.Rmd')
setwd('vignettes')
knit2html('nfl-gv.Rmd')
knitr::knit2html('nfl-gv.Rmd')
knitr::knit2html('nfl-gv.Rmd')
knitr::knit2html('nfl-gv.Rmd')
knitr::knit2html('nfl-gv.Rmd')
knitr::knit2html('nfl-gv.Rmd')
dir()
setwd('inst/extdata')
pointFile <- system.file('extdata', 'nfl2014.csv', package='nflgv')
colorFile <- system.file('extdata', 'nfl_team_colors.csv', package='nflgv')
nfl2014 <- read.csv(pointFile)
colors <- read.csv(colorFile, stringsAsFactors = FALSE)
library(nflgv)
pointFile <- system.file('extdata', 'nfl2014.csv', package='nflgv')
colorFile <- system.file('extdata', 'nfl_team_colors.csv', package='nflgv')
nfl2014 <- read.csv(pointFile)
colors <- read.csv(colorFile, stringsAsFactors = FALSE)
library(dplyr)
rm(nfl2014)
nfl2014 <- read.csv(pointFile) %>%
transmute(week = Week, winner = Winner, loser = Loser,
pts = (PtsW - PtsL) / (PtsW + PtsL))
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum)
head(colors)
head(teams)
teams <- rename(teams, team = winner)
left_join(teams, colors, by = team)
View(colors)
View(teams)
left_join(teams, colors)
nfl2014 <- read.csv(pointFile, stringsAsFactors = FALSE) %>%
transmute(week = Week, winner = Winner, loser = Loser,
pts = (PtsW - PtsL) / (PtsW + PtsL))
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum)
teams <- rename(teams, team = winner)
left_join(teams, colors)
lapply(colors, class)
lapply(teams, class)
library(nflgv)
library(dplyr)
pointFile <- system.file('extdata', 'nfl2014.csv',
package = 'nflgv')
colorFile <- system.file('extdata', 'nfl_team_colors.csv',
package = 'nflgv')
nfl2014 <- read.csv(filename, stringsAsFactors = FALSE) %>%
transmute(week = Week, winner = Winner, loser = Loser,
# percent_margin prevents favoring high scores
pts = percent_margin(PtsW, PtsL))
nfl2014 <- read.csv(pointFile, stringsAsFactors = FALSE) %>%
transmute(week = Week, winner = Winner, loser = Loser,
# percent_margin prevents favoring high scores
pts = percent_margin(PtsW, PtsL))
nfl2014 <- read.csv(pointFile, stringsAsFactors = FALSE) %>%
transmute(week = Week, winner = Winner, loser = Loser,
# percent_margin prevents favoring high scores
pts = (PtsW - PtsL) / (PtsW + PtsL))
colors <- read.csv(colorFile, stringsAsFactors = FALSE)
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum) %>%
rename(team = winner) %>%
left_join(colors)
View(teams)
View(colors)
library(nflgv)
args <- loadData()
View(args$teams)
pointFile <- system.file('extdata', 'nfl2014.csv',
package = 'nflgv')
colorFile <- system.file('extdata', 'nfl_team_colors.csv',
package = 'nflgv')
nfl2014 <- read.csv(pointFile, stringsAsFactors = FALSE) %>%
transmute(week = Week, winner = Winner, loser = Loser,
# percent_margin prevents favoring high scores
pts = percent_margin(PtsW, PtsL))
colors <- read.csv(colorFile, stringsAsFactors = FALSE)
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum) %>%
rename(team = winner)
source('~/dm-uiuc/dataviz/nfl-gv/R/utils.R')
pointFile <- system.file('extdata', 'nfl2014.csv',
package = 'nflgv')
colorFile <- system.file('extdata', 'nfl_team_colors.csv',
package = 'nflgv')
nfl2014 <- read.csv(pointFile, stringsAsFactors = FALSE) %>%
transmute(week = Week, winner = Winner, loser = Loser,
# percent_margin prevents favoring high scores
pts = percent_margin(PtsW, PtsL))
colors <- read.csv(colorFile, stringsAsFactors = FALSE)
movs <- aggregate(pts ~ winner + loser,
data = select(nfl2014, winner, loser, pts),
mean)
teams <- aggregate(pts ~ winner, data = movs, sum) %>%
rename(team = winner)
View(teams)
View(colors)
teams$team == colors$team
teams$team
colors$team
library(nflgv)
args <- loadData()
View(args$teams)
library(nflgv)
dir()
setwd('../..')
dir()
args <- loadData()
buildGraph(args$movs, args$teams)
library(nflgv)
args <- loadData()
buildGraph(args$movs, args$teams)
library(DiagrammeR)
help(create_graph)
library(nflgv)
dir()
setwd('vignettes')
knitr::knit2html('nfl-gv.Rmd')
library(nflgv)
library(nflgv)
dir()
knitr::knit2html('nfl-gv.Rmd')
library(nflgv)
knitr::knit2html('nfl-gv.Rmd')
